<header>
    <h1>Security</h1>
</header>

<div class="security-grid">
    <section class="settings-section">
        <article>
            <h2>Security Settings</h2>

            <div class="setting-item">
                <div class="setting-info">
                    <h3>Two-Factor Authentication</h3>
                    <p>Add an extra layer of security to your account</p>
                </div>
                <label class="switch">
                    <input type="checkbox" [(ngModel)]="settings.twoFactorEnabled" (change)="saveSettings()">
                    <span class="slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <h3>Password Expiry</h3>
                    <p>Require password change after period</p>
                </div>
                <select [(ngModel)]="settings.passwordExpiry" (change)="saveSettings()">
                    <option [value]="30">30 days</option>
                    <option [value]="60">60 days</option>
                    <option [value]="90">90 days</option>
                    <option [value]="0">Never</option>
                </select>
            </div>
        </article>

        <article>
            <h2>IP Whitelist</h2>
            <p class="description">Restrict access to specific IP addresses</p>

            <div class="ip-input">
                <input type="text" [(ngModel)]="newIp" placeholder="Enter IP address">
                <button (click)="addIpToWhitelist()">Add</button>
            </div>

            @if (settings.ipWhitelist.length > 0) {
                <ul class="ip-list">
                    @for (ip of settings.ipWhitelist; track ip) {
                        <li>
                            <span>{{ ip }}</span>
                            <button class="contrast small" (click)="removeIp(ip)">Ã—</button>
                        </li>
                    }
                </ul>
            } @else {
                <p class="empty">No IPs whitelisted. All IPs can access.</p>
            }
        </article>
    </section>

    <section class="audit-section">
        <article>
            <header>
                <h2>Audit Logs</h2>
                <button class="secondary small" (click)="clearAuditLogs()">Clear</button>
            </header>

            @if (auditLogs$ | async; as logs) {
                @if (logs.length > 0) {
                    <ul class="audit-list">
                        @for (log of logs; track log.id) {
                            <li>
                                <div class="log-header">
                                    <strong>{{ log.action }}</strong>
                                    <span class="timestamp">{{ formatDate(log.timestamp) }}</span>
                                </div>
                                <p>{{ log.details }}</p>
                                <span class="user">by {{ log.user }}</span>
                            </li>
                        }
                    </ul>
                } @else {
                    <p class="empty">No audit logs yet.</p>
                }
            }
        </article>
    </section>
</div>
